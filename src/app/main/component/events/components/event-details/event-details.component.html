<div class="event-wrapper">
  <app-spinner *ngIf="isPosting"></app-spinner>
  <div *ngIf="event && !isPosting" class="event">
    <div class="event-nav">
      <div class="back-button">
        <a [routerLink]="['/events']" class="button-link">
          <div class="button-content">
            <img [src]="icons.arrowLeft" aria-hidden="true" alt="" class="button-arrow-img arrow" />
            <div class="button-text">Back to Events</div>
          </div>
        </a>
      </div>

      <div *ngIf="role === roles.ORGANIZER || role === roles.ADMIN" class="edit-buttons">
        <div class="secondary-global-button delete-button">
          <span (click)="deleteEvent()">Delete</span>
        </div>
        <div class="secondary-global-button edit-button">
          <span (click)="navigateToEditEvent()">Edit</span>
        </div>
      </div>
    </div>

    <div class="event-header">
      <!-- <div class="event-meta"> -->
      <div class="left-side">
        <div class="event-title">{{ event.title }}</div>
        <div class="date-author">
          <div>Jan 30, 2020</div>
          <div>|</div>
          <div>by {{ event.organizer.name }}</div>
        </div>
        <!-- <div class="event-rating">
          <rating [(ngModel)]="rate" [customTemplate]="star" [max]="max" [readonly]="isReadonly"> </rating>
          <ng-template #star let-index="index" let-value="value">
            <span class="star {{ index < value ? 'fill' : 'empty' }}"></span>
          </ng-template>
        </div> -->
      </div>
      <div class="right-side">
        <div class="share-buttons">
          <img [src]="icons.socials.plus" alt="Share" />
          <img [src]="icons.socials.twitter" alt="Share on Twitter" />
          <img [src]="icons.socials.linkedin" alt="Share on LinkedIn" />
          <img [src]="icons.socials.facebook" alt="Share on Facebook" />
        </div>
      </div>
      <!-- </div> -->
    </div>

    <div class="event-main">
      <div class="main-left">
        <div class="main-image">
          <app-images-slider *ngIf="images.length" [images]="images"></app-images-slider>
        </div>

        <div class="event-tags-participants">
          <div class="event-tags">
            <div class="event-tag" *ngFor="let tag of event.tags">{{ tag.nameEn | uppercase }}</div>
          </div>
          <div class="event-participants">
            <div class="event-participants-avatars" *ngIf="attendeesAvatars.length">
              <!-- <div class="event-participants-avatar" *ngFor="let item of 5 | repeat">
                <div style="width:700px; height: 700px; background: rgb(22, 20, 131)"></div>
              </div> -->
              <div class="event-participants-avatar" *ngFor="let avatar of attendeesAvatars">
                <img [src]="avatar" alt="" />
              </div>
            </div>
            <div class="event-participants-count-container">
              <span class="event-participants-count">{{ attendees.length }}</span
              >&nbsp;
              <span>people are going</span>
            </div>
          </div>
        </div>

        <div class="event-info-block">
          <div class="event-info">
            <div class="event-date">
              <div class="event-date-icon">
                <img [src]="icons.clock" alt="" />
              </div>
              <div class="event-date-content" *ngIf="event.dates.length === 1; else multipleDays">
                <div class="event-duration">{{ event.dates[0].startDate | date: 'MMM d, y' }}</div>
                <div>|</div>
                <div>{{ event.dates[0].startDate | date: 'hh:mm a' }}</div>
              </div>
              <ng-template #multipleDays>
                <div class="event-date-content">
                  <div class="event-duration">
                    {{ event.dates[0].startDate | date: 'MMM d, y' }}
                    &nbsp;-&nbsp;
                    {{ event.dates[event.dates.length - 1].finishDate | date: 'MMM d, y' }}
                  </div>
                  <div>|</div>
                  <div>{{ event.dates[0].startDate | date: 'hh:mm a' }}</div>
                </div>
              </ng-template>
            </div>
            <div class="event-location">
              <div class="event-location-icon">
                <img [src]="icons.location" alt="" />
              </div>
              <div>{{ event.dates[0].onlineLink ? event.dates[0].onlineLink : event.dates[0].coordinates.addressEn }}</div>
            </div>
            <div class="event-status-access">
              <div class="event-status-icon">
                <img [src]="icons.lock" alt="" />
              </div>
              <div class="event-status-access-content">
                <div class="event-status">{{ event.open ? 'Open' : 'Finished' }}</div>
                <div>|</div>
                <div>Anyone registered</div>
              </div>
            </div>
            <div class="event-author">
              <div class="event-author-icon">
                <img [src]="icons.user" alt="" />
              </div>
              <div>John Smith</div>
            </div>
          </div>
          <div class="event-info-days">
            <app-event-schedule-overlay [event]="event"></app-event-schedule-overlay>
            <!-- <button class="more-days-info-button" aria-label="Days info" *ngIf="event.dates.length > 1" (click)="onScheduleClick()" #scheduleButton>
              <img [src]="icons.ellipsis" alt="Days" />
            </button> -->
            <!-- <mat-menu class="event-info-days-overlay" #moreDaysInfo="matMenu">
              <div class="event-date-place-block-two-days" *ngIf="event.dates.length === 2">
                <div class="event-date-place-day-block" *ngFor="let day of event.dates; index as idx">
                  <div class="day-number">{{ idx + 1 }}&nbsp;Day</div>
                  <div class="event-date-place">
                    <div class="event-date">
                      <div class="event-date-icon">
                        <img [src]="icons.clock" alt="" />
                      </div>
                      <div>
                        {{ day.startDate | date: 'MMM d, y' }} | {{ day.startDate | date: 'hh:mm a' }}&nbsp;-&nbsp;{{
                          day.finishDate | date: 'hh:mm a'
                        }}
                      </div>
                    </div>
                    <div class="event-location">
                      <div class="event-location-icon">
                        <img [src]="icons.location" alt="" />
                      </div>
                      <div>{{ day.onlineLink ? day.onlineLink : day.coordinates.addressEn }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="event-date-place-block-three-and-more-days" *ngIf="event.dates.length >= 3">
                <div class="event-date-place-block-content">
                  <div class="event-date-place-day-block" *ngFor="let day of event.dates; index as idx">
                    <div class="day-number">{{ idx + 1 }}&nbsp;Day</div>
                    <div class="event-date-place">
                      <div class="event-date">
                        {{ day.startDate | date: 'MMM d, y' }} | {{ day.startDate | date: 'hh:mm a' }}&nbsp;-&nbsp;{{
                          day.finishDate | date: 'hh:mm a'
                        }}
                      </div>
                      <div class="event-location">{{ day.onlineLink ? day.onlineLink : day.coordinates.addressEn }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-menu> -->
          </div>
        </div>

        <div class="save-join-event-block" *ngIf="role === roles.USER">
          <button class="save-event">Save event</button>
          <button class="join-event">Join event</button>
        </div>
      </div>

      <div class="main-right">
        <div class="description-block-title">Description</div>
        <div [innerHTML]="event.description"></div>
      </div>
    </div>
  </div>
</div>
