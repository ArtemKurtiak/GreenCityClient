<div class="new-message-window">
  <div class="new-msg-title">
    <span class="msg-title">New Message</span>
    <button class="close-new-msg" (click)="close()" title="Close">&times;</button>
  </div>
  <div class="receiver" *ngIf="chatsService.currentChat; else userSearch">
    <div class="account">
      <img [src]="chatIcons.userLogo" alt="user-logo" />
      <span class="chat-name">{{ chatsService.currentChat.name }}</span>
    </div>
    <span class="reset-receiver" title="Remove receiver" (click)="chatsService.setCurrentChat(null)">&times;</span>
  </div>

  <textarea placeholder="Type a message..." [formControl]="messageControl"></textarea>
  <div class="message-sender">
    <div class="sender-additional-buttons">
      <button>
        <img [src]="chatIcons.paperClip" alt="clip" title="Add file" />
      </button>
      <button>
        <img [src]="chatIcons.smile" alt="smile" title="Add emoji" (click)="toggleEmojiPicker()" />
      </button>
    </div>
    <button class="send-button" (click)="sendMessage()" [disabled]="!messageControl.value || !chatsService.currentChat">
      <img [src]="chatIcons.send" alt="send" title="Send mail" />
    </button>
  </div>
  <emoji-mart
    *ngIf="showEmojiPicker"
    class="emoji-mart"
    [emojiSize]="20"
    [totalFrequentLines]="2"
    [darkMode]="false"
    [showPreview]="false"
    (emojiSelect)="addEmoji($event)"
    title="Pick your emojiâ€¦"
  ></emoji-mart>
</div>

<ng-template #userSearch>
  <input type="text" class="search-field" placeholder="Search user..." [formControl]="userSearchControl" />
  <div class="search-dropdown" [class.active]="userSearchControl.value">
    <div class="chats-search-suggest" *ngFor="let friend of chatsService.searchedFriendsStream$ | async" (click)="checkChat(friend)">
      <img [src]="chatIcons.userLogo" alt="user-logo" />
      <span class="chat-name">{{ friend.name }}</span>
    </div>
  </div>
</ng-template>
